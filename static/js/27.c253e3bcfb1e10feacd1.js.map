{"version":3,"sources":["webpack:///./src/views/me/ChangePhone.vue?bd47","webpack:///src/views/me/ChangePhone.vue","webpack:///./src/views/me/ChangePhone.vue?6389","webpack:///./src/views/me/ChangePhone.vue"],"names":["module","exports","Component","options","__i18n","push","_Ctor","ChangePhone","data","_this","this","form","code","phone","rules","required","pattern","validate","message","$t","trigger","validator","rule","value","callback","$store","getters","userInfo","Error","len","loading","sending","count","timer","computed","sendButtonText","methods","onSend","_this2","Object","type","user","then","countDown","catch","$message","warning","onSubmit","_this3","$refs","valid","_form","commit","success","_this4","setTimeout","clearTimeout","me_ChangePhone","render","_vm","_h","$createElement","_c","_self","staticClass","directives","name","rawName","expression","_v","ref","attrs","model","label-position","label","disabled","prop","$$v","$set","slot","on","click","_s","staticRenderFns","__vue_styles__","context","__webpack_require__","component_normalizer","customBlock","__esModule","default","__webpack_exports__"],"mappings":"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","file":"static/js/27.c253e3bcfb1e10feacd1.js","sourcesContent":["module.exports = function (Component) {\n  Component.options.__i18n = Component.options.__i18n || []\n  Component.options.__i18n.push('{\"zh\":{\"countdown\":\"重新获取验证码({count})\"},\"en\":{\"修改绑定手机号\":\"Change Phone Number\",\"已绑定手机号\":\"Current phone number\",\"更换手机号\":\"New phone number\",\"获取验证码\":\"Send verification code\",\"验证码\":\"Verification code\",\"确 定\":\"Submit\",\"请输入合法手机号\":\"Please enter a valid phone number\",\"新手机号不能与原手机号相同\":\"New and original phone number cannot be same\",\"请输入6位验证码\":\"Please enter 6 characters verification code\",\"修改绑定手机号成功\":\"Successfully change phone number\",\"countdown\":\"Resend verification code ({count})\"}}')\n  delete Component.options._Ctor\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/@kazupon/vue-i18n-loader/lib!./node_modules/vue-loader/lib/selector.js?type=customBlocks&index=0!./src/views/me/ChangePhone.vue\n// module id = K01m\n// module chunks = 27","<i18n>\n{\n  \"zh\": {\n    \"countdown\": \"重新获取验证码({count})\"\n  },\n  \"en\": {\n    \"修改绑定手机号\": \"Change Phone Number\",\n    \"已绑定手机号\": \"Current phone number\",\n    \"更换手机号\": \"New phone number\",\n    \"获取验证码\": \"Send verification code\",\n    \"验证码\": \"Verification code\",\n    \"确 定\": \"Submit\",\n    \"请输入合法手机号\": \"Please enter a valid phone number\",\n    \"新手机号不能与原手机号相同\": \"New and original phone number cannot be same\",\n    \"请输入6位验证码\": \"Please enter 6 characters verification code\",\n    \"修改绑定手机号成功\": \"Successfully change phone number\",\n    \"countdown\": \"Resend verification code ({count})\"\n  }\n}\n</i18n>\n\n<template>\n  <div class=\"container\">\n    <h2\n      v-t=\"'修改绑定手机号'\"\n      class=\"mt0\" />\n    <el-form\n      ref=\"form\"\n      :rules=\"rules\"\n      :model=\"form\"\n      label-position=\"top\">\n      <el-form-item :label=\"$t('已绑定手机号')\">\n        <el-input\n          :value=\"$store.getters.userInfo.phone\"\n          disabled/>\n      </el-form-item>\n      <el-form-item\n        :label=\"$t('更换手机号')\"\n        prop=\"phone\">\n        <el-input v-model=\"form.phone\">\n          <el-button\n            slot=\"append\"\n            :loading=\"sending\"\n            :disabled=\"!!count\"\n            @click=\"onSend\">{{ sendButtonText }} </el-button>\n        </el-input>\n      </el-form-item>\n      <el-form-item\n        :label=\"$t('验证码')\"\n        prop=\"code\">\n        <el-input v-model=\"form.code\"/>\n      </el-form-item>\n      <el-form-item>\n        <el-button\n          :loading=\"loading\"\n          type=\"primary\"\n          @click=\"onSubmit\">{{ $t('确 定') }}</el-button>\n      </el-form-item>\n    </el-form>\n  </div>\n</template>\n\n<script>\nimport { phonePattern, validatePhone } from '@/utils/validate'\nimport { changePhone, sendCode, checkPhoneAvailable } from '@/api/user'\nexport default {\n  data () {\n    return {\n      form: {\n        code: '',\n        phone: ''\n      },\n      rules: {\n        phone: [\n          { required: true, pattern: phonePattern, message: this.$t('请输入合法手机号'), trigger: 'blur' },\n          {\n            validator: (rule, value, callback) => {\n              if (this.form.phone === this.$store.getters.userInfo.phone) {\n                callback(new Error(this.$t('新手机号不能与原手机号相同')))\n              }\n              callback()\n            }\n          }\n        ],\n        code: { required: true, len: 6, message: this.$t('请输入6位验证码'), trigger: 'blur' }\n      },\n      loading: false,\n      sending: false, // 是否正在发送验证码\n      count: 0, // 倒计时\n      timer: null // 计时器\n    }\n  },\n  computed: {\n    sendButtonText () {\n      const { count } = this\n      if (count) {\n        return this.$t('countdown', { count })\n      } else {\n        return this.$t('获取验证码')\n      }\n    }\n  },\n  methods: {\n    onSend () {\n      if (validatePhone(this.form.phone)) {\n        this.sending = true\n        const { phone } = this.form\n        const type = this.$store.getters.userInfo.type\n        checkPhoneAvailable(phone, type).then(() => {\n          return sendCode(phone, type, 'changePhone').then(() => {\n            this.sending = false\n            this.count = 60\n            this.countDown()\n          })\n        }).catch(() => {\n          this.sending = false\n        })\n      } else {\n        this.$message.warning(this.$t('请输入合法手机号'))\n      }\n    },\n    onSubmit () {\n      this.$refs.form.validate((valid) => {\n        if (valid) {\n          this.loading = true\n          const { code, phone } = this.form\n          changePhone(code, phone).then(() => {\n            this.loading = false\n            this.form = {\n              phone: '',\n              code: ''\n            }\n            this.$store.commit('SET_PHONE', phone)\n            this.$message.success(this.$t('修改绑定手机号成功'))\n          }).catch(() => {\n            this.loading = false\n          })\n        }\n      })\n    },\n    countDown () {\n      if (this.count > 0) {\n        this.count--\n        this.timer = setTimeout(() => {\n          this.countDown()\n        }, 1000)\n      } else {\n        clearTimeout(this.timer)\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.container {\n  position: relative;\n  padding: 24px 32px;\n  .el-form {\n    width: 600px;\n  }\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/views/me/ChangePhone.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container\"},[_c('h2',{directives:[{name:\"t\",rawName:\"v-t\",value:('修改绑定手机号'),expression:\"'修改绑定手机号'\"}],staticClass:\"mt0\"}),_vm._v(\" \"),_c('el-form',{ref:\"form\",attrs:{\"rules\":_vm.rules,\"model\":_vm.form,\"label-position\":\"top\"}},[_c('el-form-item',{attrs:{\"label\":_vm.$t('已绑定手机号')}},[_c('el-input',{attrs:{\"value\":_vm.$store.getters.userInfo.phone,\"disabled\":\"\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":_vm.$t('更换手机号'),\"prop\":\"phone\"}},[_c('el-input',{model:{value:(_vm.form.phone),callback:function ($$v) {_vm.$set(_vm.form, \"phone\", $$v)},expression:\"form.phone\"}},[_c('el-button',{attrs:{\"slot\":\"append\",\"loading\":_vm.sending,\"disabled\":!!_vm.count},on:{\"click\":_vm.onSend},slot:\"append\"},[_vm._v(_vm._s(_vm.sendButtonText)+\" \")])],1)],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":_vm.$t('验证码'),\"prop\":\"code\"}},[_c('el-input',{model:{value:(_vm.form.code),callback:function ($$v) {_vm.$set(_vm.form, \"code\", $$v)},expression:\"form.code\"}})],1),_vm._v(\" \"),_c('el-form-item',[_c('el-button',{attrs:{\"loading\":_vm.loading,\"type\":\"primary\"},on:{\"click\":_vm.onSubmit}},[_vm._v(_vm._s(_vm.$t('确 定')))])],1)],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-75865050\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/me/ChangePhone.vue\n// module id = null\n// module chunks = ","function injectStyle (context) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-75865050\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./ChangePhone.vue\")\n}\nimport normalizeComponent from \"!../../../node_modules/vue-loader/lib/runtime/component-normalizer\"\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./ChangePhone.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./ChangePhone.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-75865050\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./ChangePhone.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-75865050\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\n/* customBlocks */\nvar customBlock = require(\"!!@kazupon/vue-i18n-loader!../../../node_modules/vue-loader/lib/selector?type=customBlocks&index=0!./ChangePhone.vue\")\nif (customBlock && customBlock.__esModule) {\n  customBlock = customBlock.default\n}\nif (typeof customBlock === \"function\") {\n  customBlock(Component)\n}\n\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/me/ChangePhone.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}