webpackJsonp([34],{"+pYd":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o("XyMi"),i=o("3nZr"),s={data:function(){return{users:[],pageCount:1,currentPage:1,loading:!0,error:!1,followLoadings:{}}},computed:{pageType:function(){return this.$route.query.type||"following"},pageUID:function(){return this.$route.query.uid||this.$store.getters.uid},isCurrentUser:function(){return this.pageUID==this.$store.getters.uid}},created:function(){this.$route.query.p&&(this.currentPage=parseInt(this.$route.query.p)),this.getUsers()},methods:{getUsers:function(){var t=this;this.loading=!0,this.error=!1;var e=this.currentPage,o=this.pageUID;("following"===this.pageType?i.c:i.b)(o,e).then(function(e){var o=e.data,n=o.data,i=o.meta.pagination;t.loading=!1,t.pageCount=i.total_pages,t.users=n}).catch(function(){t.loading=!1,t.error=!0})},onToggleFollow:function(t){var e=this;if(!this.followLoadings[t]){this.$set(this.followLoadings,t,!0);var o=this.users[t],n=o.following?"UNFOLLOW":"FOLLOW";this.$store.dispatch(n,o.id).then(function(){o.following=!o.following,e.followLoadings[t]=!1}).catch(function(){e.followLoadings[t]=!1})}},onSelectMenuItem:function(t){this.$router.push({path:this.$route.path,query:{type:t,uid:this.pageUID}})},onChangePage:function(t){this.$router.push({path:this.$route.path,query:{type:this.pageType,uid:this.pageUID,p:t}})}}},r={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"main-container"},[o("div",{staticClass:"card"},[o("el-menu",{staticStyle:{padding:"0 32px"},attrs:{"default-active":t.pageType,mode:"horizontal"},on:{select:t.onSelectMenuItem}},[o("el-menu-item",{attrs:{index:"following"}},[t._v(t._s(t.isCurrentUser?t.$t("我关注的人"):t.$t("Ta关注的人")))]),t._v(" "),t.$isDesigner()?o("el-menu-item",{attrs:{index:"follower"}},[t._v(t._s(t.isCurrentUser?t.$t("关注我的人"):t.$t("关注Ta的人")))]):t._e()],1),t._v(" "),t.loading||t.error?o("my-loader",{attrs:{loading:t.loading,error:t.error,"btn-text":t.$t("重新加载"),"on-reload":t.getUsers}}):t.users.length?[o("div",{staticClass:"user-list"},t._l(t.users,function(e,n){return o("div",{key:e.id,staticClass:"user-list-item"},[o("router-link",{attrs:{to:"/profile?uid="+e.id}},[o("my-avatar",{staticClass:"user-list-item__avatar",attrs:{"avatar-url":e.avatar_url}})],1),t._v(" "),o("div",{staticClass:"user-list-item__info"},[o("router-link",{staticClass:"bold black-85",attrs:{to:"/profile?uid="+e.id}},[t._v(t._s(e.name))]),t._v(" "),o("p",[o("span",{staticClass:"color-primary"},[t._v(t._s(t.$t("关注")))]),t._v(" "),o("span",{domProps:{textContent:t._s(e.following_count)}}),t._v(" "),o("span",{staticClass:"color-primary"},[t._v(t._s(t.$t("粉丝")))]),t._v(" "),o("span",{domProps:{textContent:t._s(e.follower_count)}})]),t._v(" "),o("p",{domProps:{textContent:t._s(e.title)}}),t._v(" "),o("p",{domProps:{textContent:t._s(e.introduction)}})],1),t._v(" "),e.following?o("el-button",{staticClass:"list-item__action",attrs:{loading:t.followLoadings[n],plain:"",size:"mini"},on:{click:function(e){t.onToggleFollow(n)}}},[t._v(t._s(t.$t("取消关注")))]):o("el-button",{staticClass:"list-item__action",attrs:{loading:t.followLoadings[n],plain:"",type:"primary",size:"mini"},on:{click:function(e){t.onToggleFollow(n)}}},[t._v(t._s(t.$t("关注")))])],1)})),t._v(" "),o("el-pagination",{attrs:{"current-page":t.currentPage,"page-count":t.pageCount,background:"",layout:"prev, pager, next"},on:{"update:currentPage":function(e){t.currentPage=e},"current-change":t.onChangePage}})]:o("my-empty")],2)])},staticRenderFns:[]};var a=function(t){o("7WPw")},l=Object(n.a)(s,r,!1,a,"data-v-130d683f",null),u=o("zmSk");u&&u.__esModule&&(u=u.default),"function"==typeof u&&u(l);e.default=l.exports},"7WPw":function(t,e){},zmSk:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"en":{"我关注的人":"Following","关注我的人":"Followers","Ta关注的人":"Following","关注Ta的人":"Followers","关注":"Following","粉丝":"Follower","取消关注":"Unfollow"}}'),delete t.options._Ctor}}});
//# sourceMappingURL=34.08be07ae4ae16d977b6d.js.map